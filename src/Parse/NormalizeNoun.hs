module Parse.NormalizeNoun
       ( normalizeNoun ) where

import qualified Data.HashMap.Strict as Map
import Control.Monad
import qualified Data.List as List

type IrregularNouns = Map.HashMap String String

-- I will want to implement this eventually,
-- but only once I can run the hashmap through the program.
irregularNouns :: IrregularNouns
irregularNouns = Map.fromList irregularPlurals

normalizeNoun :: String -> String
normalizeNoun noun =
    case lookup noun irregularPlurals of
        Just sing -> sing
        Nothing   -> stem noun

stem :: String -> String
stem s
    | s `ends` "ies" = s `dropLast` 3 ++ "y"
    | s `ends` "es"  = s `dropLast` 2
    | s `ends` "ss"  = s
    | s `ends` "s"   = s `dropLast` 1
    | otherwise = s
    where
        ends = flip List.isSuffixOf
        s `dropLast` n = take (length s - n) s
    
-- assumes the suffix has alrady been tested for:
stripKnownSuffix :: String -> String -> String
stripKnownSuffix str suffix = take n str
    where
        n = length str - length suffix

-- The following list is a modified from of the list located here: https://github.com/jerity/jerity/blob/master/tests/Util/singular-plural-wordlist.txt
irregularPlurals :: [(String, String)]
irregularPlurals =
    [("Jesuses","Jesus"),("abbreviations","abbreviation"),("accesses","access"),("accounts","account"),("acknowledgements","acknowledgement"),("acronyms","acronym"),("actions","action"),("activations","activation"),("activities","activity"),("additives","additive"),("addresses","address"),("adjectives","adjective"),("administrators","administrator"),("affiliates","affiliate"),("affiliations","affiliation"),("ages","age"),("agents","agent"),("agenda","agendum"),("albinos","albino"),("albums","album"),("alerts","alert"),("algae","alga"),("aliases","alias"),("alumnae","alumna"),("alumni","alumnus"),("amounts","amount"),("analyses","analysis"),("analysts","analyst"),("analytics","analytics"),("ancestors","ancestor"),("anchors","anchor"),("angles","angle"),("animations","animation"),("answers","answer"),("apices","apex"),("applications","application"),("archipelagos","archipelago"),("archives","archive"),("areas","area"),("arguments","argument"),("arrays","array"),("arthritis","arthritis"),("articles","article"),("ascenders","ascender"),("ascensores","ascensor"),("associations","association"),("atlases","atlas"),("attachments","attachment"),("attributes","attribute"),("authentications","authentication"),("authors","author"),("authorities","authority"),("automata","automaton"),("averages","average"),("axes","axis"),("bacilli","bacillus"),("backs","back"),("backgrounds","background"),("backtraces","backtrace"),("bacteria","bacterium"),("banners","banner"),("bars","bar"),("bases","base"),("batches","batch"),("beefs","beef"),("behaviors","behavior"),("behaviours","behaviour"),("benchmarks","benchmark"),("birthdays","birthday"),("bison","bison"),("bits","bit"),("blanks","blank"),("blocks","block"),("bodies","body"),("bookmarks","bookmark"),("borders","border"),("bottoms","bottom"),("bounces","bounce"),("bounds","bound"),("boundaries","boundary"),("bourgeois","bourgeois"),("boxes","box"),("branches","branch"),("breadcrumbs","breadcrumb"),("breaks","break"),("bream","bream"),("breeches","breeches"),("britches","britches"),("broths","broth"),("brothers","brother"),("buffalo","buffalo"),("builders","builder"),("bundles","bundle"),("buoys","buoy"),("bureaus","bureau"),("buttons","button"),("buses","bus"),("bytes","byte"),("cacaos","cacao"),("caches","cache"),("cacti","cactus"),("calendars","calendar"),("calves","calf"),("callbacks","callback"),("cameos","cameo"),("campaigns","campaign"),("cancellations","cancellation"),("candelabra","candelabrum"),("cantus","cantus"),("canvases","canvas"),("capacities","capacity"),("captions","caption"),("captives","captive"),("captures","capture"),("cards","card"),("carp","carp"),("carrots","carrot"),("carousels","carousel"),("cases","case"),("casinos","casino"),("cats","cat"),("categories","category"),("causes","cause"),("cells","cell"),("certificates","certificate"),("changes","change"),("channels","channel"),("characters","character"),("charges","charge"),("chassis","chassis"),("checks","check"),("checkboxes","checkbox"),("cheques","cheque"),("chickens","chicken"),("chickenpox","chickenpox"),("children","child"),("chinese","chinese"),("chives","chive"),("choices","choice"),("choosers","chooser"),("churches","church"),("classes","class"),("clauses","clause"),("clicks","click"),("clients","client"),("clips","clip"),("clipboards","clipboard"),("clippers","clippers"),("clones","clone"),("closes","close"),("closures","closure"),("cloves","clove"),("cod","cod"),("codes","code"),("codices","codex"),("coffees","coffee"),("collapses","collapse"),("colors","color"),("colours","colour"),("columns","column"),("commands","command"),("commandos","commando"),("comments","comment"),("comparators","comparator"),("comparisons","comparison"),("competitions","competition"),("composites","composite"),("computations","computation"),("conditions","condition"),("configurations","configuration"),("confirmations","confirmation"),("conjugations","conjugation"),("conjunctions","conjunction"),("connections","connection"),("constants","constant"),("constraints","constraint"),("constructors","constructor"),("contacts","contact"),("containers","container"),("contents","content"),("contexts","context"),("contretemps","contretemps"),("controls","control"),("controllers","controller"),("cookies","cookie"),("coordinates","coordinate"),("coordinators","coordinator"),("copyrights","copyright"),("corps","corps"),("corpuses","corpus"),("cortices","cortex"),("counts","count"),("countries","country"),("covers","cover"),("cows","cow"),("creations","creation"),("creators","creator"),("credentials","credential"),("credits","credit"),("crises","crisis"),("criteria","criterion"),("crocuses","crocus"),("currencies","currency"),("currents","current"),("cursors","cursor"),("customisations","customisation"),("databases","database"),("datastores","datastore"),("dates","date"),("datestamps","datestamp"),("data","datum"),("days","day"),("debris","debris"),("declarations","declaration"),("declensions","declension"),("decorators","decorator"),("deer","deer"),("defaults","default"),("definitions","definition"),("delimiters","delimiter"),("deliveries","delivery"),("delouses","delouse"),("dependants","dependant"),("dependencies","dependency"),("descendants","descendant"),("descenders","descender"),("descensos","descenso"),("descriptions","description"),("details","detail"),("deviations","deviation"),("diabetes","diabetes"),("diagnoses","diagnosis"),("dialogs","dialog"),("dialogues","dialogue"),("differences","difference"),("dimensions","dimension"),("directions","direction"),("directives","directive"),("directories","directory"),("displays","display"),("dispositions","disposition"),("dissertations","dissertation"),("dittos","ditto"),("djinn","djinn"),("dynamo","dynamo"),("doctorates","doctorate"),("documents","document"),("domains","domain"),("donations","donation"),("downloads","download"),("drags","drag"),("drives","drive"),("drops","drop"),("duchesses","duchess"),("duos","duo"),("durations","duration"),("dynamics","dynamic"),("dynamo","dynamo"),("dwarves","dwarf"),("e-mails","e-mail"),("edits","edit"),("editors","editor"),("educations","education"),("elements","element"),("elves","elf"),("elk","elk"),("emails","email"),("encodings","encoding"),("encryptions","encryption"),("embryos","embryo"),("employees","employee"),("employers","employer"),("enclosures","enclosure"),("ends","end"),("entities","entity"),("entries","entry"),("environments","environment"),("equipment","equipment"),("errata","erratum"),("errors","error"),("escapes","escape"),("events","event"),("exceptions","exception"),("exclusions","exclusion"),("existences","existence"),("expansions","expansion"),("exports","export"),("extensions","extension"),("externals","external"),("extras","extra"),("extrema","extremum"),("faces","face"),("factors","factor"),("factories","factory"),("failures","failure"),("fairs","fair"),("families","family"),("faxes","fax"),("features","feature"),("feeds","feed"),("feedback","feedback"),("fiascos","fiasco"),("fields","field"),("figures","figure"),("files","file"),("filters","filter"),("fingerprints","fingerprint"),("fish","fish"),("fixes","fix"),("fixtures","fixture"),("fizzes","fizz"),("flags","flag"),("flounder","flounder"),("flows","flow"),("flies","fly"),("flyers","flyer"),("foci","focus"),("folders","folder"),("fonts","font"),("food_menus","food_menu"),("feet","foot"),("footers","footer"),("forces","force"),("foregrounds","foreground"),("foreigners","foreigner"),("forms","form"),("formats","format"),("formatters","formatter"),("formulae","formula"),("fora","forum"),("frames","frame"),("friends","friend"),("functions","function"),("fungi","fungus"),("fusses","fuss"),("futures","future"),("gallows","gallows"),("gallows","gallows"),("ganglions","ganglion"),("generators","generator"),("genies","genie"),("genres","genre"),("genera","genus"),("geometries","geometry"),("ghettos","ghetto"),("gloves","glove"),("geese","goose"),("graces","grace"),("graffiti","graffito"),("grandchildren","grandchild"),("grants","grant"),("graphics","graphic"),("groups","group"),("grouses","grouse"),("hacks","hack"),("hackers","hacker"),("halves","half"),("handles","handle"),("handlers","handler"),("hashes","hash"),("heads","head"),("headers","header"),("headings","heading"),("headquarters","headquarters"),("heights","height"),("helpers","helper"),("heroes","hero"),("herpes","herpes"),("hierarchies","hierarchy"),("highlights","highlight"),("hijinks","hijinks"),("hints","hint"),("histories","history"),("hives","hive"),("homes","home"),("homework","homework"),("hooves","hoof"),("hosts","host"),("hours","hour"),("houses","house"),("housework","housework"),("hubris","hubris"),("ibexes","ibex"),("icons","icon"),("images","image"),("imports","import"),("impressions","impression"),("includes","include"),("increments","increment"),("indents","indent"),("indices","index"),("infernos","inferno"),("information","information"),("initials","initial"),("innards","innard"),("innings","innings"),("innovations","innovation"),("inputs","input"),("inserts","insert"),("insertions","insertion"),("installations","installation"),("instances","instance"),("instantiations","instantiation"),("interests","interest"),("intervals","interval"),("invalids","invalid"),("invitations","invitation"),("invites","invite"),("issues","issue"),("italics","italic"),("items","item"),("iterators","iterator"),("jackanapes","jackanapes"),("japanese","japanese"),("joins","join"),("jumbos","jumbo"),("junk","junk"),("keys","key"),("keystrokes","keystroke"),("knives","knife"),("labels","label"),("languages","language"),("lapses","lapse"),("latices","latex"),("layers","layer"),("laymen","layman"),("layouts","layout"),("leaves","leaf"),("leaps","leap"),("leases","lease"),("legacies","legacy"),("lengths","length"),("levels","level"),("libraries","library"),("licenses","license"),("lives","life"),("limits","limit"),("lines","line"),("lingos","lingo"),("links","link"),("lists","list"),("listeners","listener"),("loads","load"),("loaves","loaf"),("locals","local"),("locations","location"),("locks","lock"),("logs","log"),("loggers","logger"),("lice","louse"),("machines","machine"),("mackerel","mackerel"),("macros","macro"),("mailings","mailing"),("men","man"),("man-children","man-child"),("managers","manager"),("manifestos","manifesto"),("manuals","manual"),("maps","map"),("margins","margin"),("markers","marker"),("masks","mask"),("masses","mass"),("masters","master"),("matches","match"),("matrices","matrix"),("matrix_rows","matrix_row"),("measles","measles"),("media","medium"),("members","member"),("memberships","membership"),("mementos","memento"),("menus","menu"),("merges","merge"),("meshes","mesh"),("messes","mess"),("messages","message"),("methods","method"),("metrics","metric"),("minutes","minute"),("missions","mission"),("mocks","mock"),("modes","mode"),("models","model"),("moderators","moderator"),("modifiers","modifier"),("modules","module"),("monies","money"),("monkeys","monkey"),("months","month"),("mongooses","mongoose"),("monkfish","monkfish"),("moose","moose"),("mice","mouse"),("moves","move"),("movies","movie"),("multimedia","multimedia"),("multiples","multiple"),("mumps","mumps"),("murecis","murex"),("mythoi","mythos"),("names","name"),("namespaces","namespace"),("nations","nation"),("nests","nest"),("nets","net"),("networks","network"),("news","news"),("newsletters","newsletter"),("nexus","nexus"),("ninjas","ninja"),("nodes","node"),("notes","note"),("notifications","notification"),("nouns","noun"),("nuclei","nucleus"),("numbers","number"),("numina","numen"),("obfuscations","obfuscation"),("objects","object"),("objectives","objective"),("occiputs","occiput"),("octopuses","octopus"),("officers","officer"),("officials","official"),("offsets","offset"),("oleos","oleo"),("opacities","opacity"),("opposites","opposite"),("options","option"),("opuses","opus"),("orders","order"),("organisers","organiser"),("orientations","orientation"),("originals","original"),("others","other"),("outlines","outline"),("outputs","output"),("overlays","overlay"),("overrides","override"),("ova","ovum"),("owners","owner"),("oxen","ox"),("packages","package"),("paddings","padding"),("pages","page"),("pagers","pager"),("palettes","palette"),("panes","pane"),("panels","panel"),("pannini","pannino"),("papers","paper"),("paragraphs","paragraph"),("parameters","parameter"),("parents","parent"),("parentheses","parenthesis"),("parses","parse"),("parsers","parser"),("particles","particle"),("passwords","password"),("patents","patent"),("paths","path"),("patterns","pattern"),("payees","payee"),("payers","payer"),("payments","payment"),("pears","pear"),("peers","peer"),("penises","penis"),("peoples","peoples"),("percentages","percentage"),("permissions","permission"),("people","person"),("photos","photo"),("pictures","picture"),("pincers","pincers"),("pipes","pipe"),("places","place"),("placeholders","placeholder"),("plains","plain"),("planes","plane"),("pliers","pliers"),("plots","plot"),("plotters","plotter"),("plugins","plugin"),("poems","poem"),("points","point"),("polls","poll"),("pollings","polling"),("ponies","pony"),("pools","pool"),("ports","port"),("portraits","portrait"),("positions","position"),("posts","post"),("potatoes","potato"),("powerhouses","powerhouse"),("pox","pox"),("precisions","precision"),("preferences","preference"),("prefixes","prefix"),("preparations","preparation"),("previews","preview"),("prices","price"),("primaries","primary"),("prints","print"),("priorities","priority"),("privacies","privacy"),("pros","pro"),("probabilities","probability"),("probosces","proboscis"),("proceedings","proceedings"),("profiles","profile"),("prognoses","prognosis"),("progresses","progress"),("projects","project"),("prompts","prompt"),("properties","property"),("proprietaries","proprietary"),("protocols","protocol"),("prototypes","prototype"),("protozoa","protozoon"),("publishers","publisher"),("purchases","purchase"),("purchasers","purchaser"),("quantities","quantity"),("qualifiers","qualifier"),("quantifiers","quantifier"),("quarries","quarry"),("quarters","quarter"),("queries","query"),("quests","quest"),("questions","question"),("queues","queue"),("quizzes","quiz"),("quotas","quota"),("rabies","rabies"),("radios","radio"),("radii","radius"),("ranges","range"),("rates","rate"),("ratings","rating"),("readers","reader"),("receivers","receiver"),("recipients","recipient"),("records","record"),("recorders","recorder"),("rectangles","rectangle"),("redirects","redirect"),("redirectors","redirector"),("references","reference"),("referrers","referrer"),("refreshes","refresh"),("regions","region"),("registers","register"),("registrations","registration"),("reindeer","reindeer"),("relations","relation"),("relatives","relative"),("releases","release"),("reloads","reload"),("remotes","remote"),("renders","render"),("renderers","renderer"),("renderings","rendering"),("replacements","replacement"),("replies","reply"),("reports","report"),("reporters","reporter"),("requests","request"),("requirements","requirement"),("resets","reset"),("resources","resource"),("responses","response"),("restrictions","restriction"),("results","result"),("retrievals","retrieval"),("returns","return"),("revisions","revision"),("rhinos","rhino"),("rhinoceros","rhinoceros"),("rights","right"),("rice","rice"),("rodeos","rodeo"),("roots","root"),("rotations","rotation"),("rows","row"),("rules","rule"),("runtimes","runtime"),("sales","sale"),("salmon","salmon"),("samples","sample"),("saves","save"),("scales","scale"),("scenarios","scenario"),("scissors","scissors"),("schemes","scheme"),("scopes","scope"),("screens","screen"),("scripts","script"),("scrolls","scroll"),("searches","search"),("sea-bass","sea-bass"),("seconds","second"),("secrets","secret"),("sections","section"),("selections","selection"),("selectors","selector"),("senders","sender"),("serfs","serf"),("series","series"),("servers","server"),("sessions","session"),("sets","set"),("settings","setting"),("sexes","sex"),("shadows","shadow"),("shears","shears"),("sheep","sheep"),("sheets","sheet"),("shoes","shoe"),("shops","shop"),("shorts","short"),("siblings","sibling"),("sides","side"),("signs","sign"),("signatures","signature"),("singles","single"),("silices","silex"),("simplices","simplex"),("sites","site"),("sizes","size"),("slices","slice"),("slides","slide"),("sliders","slider"),("smallpox","smallpox"),("societies","society"),("soliloquies","soliloquy"),("sorts","sort"),("soups","soup"),("sources","source"),("spaces","space"),("spacers","spacer"),("species","species"),("spellers","speller"),("sponsors","sponsor"),("standards","standard"),("starts","start"),("states","state"),("statements","statement"),("statistics","statistic"),("statuses","status"),("steps","step"),("stimuli","stimulus"),("stores","store"),("stories","story"),("strata","stratum"),("streams","stream"),("strikes","strike"),("strings","string"),("strongmen","strongman"),("stubs","stub"),("styles","style"),("subjects","subject"),("submissions","submission"),("subscribers","subscriber"),("subscriptions","subscription"),("suffixes","suffix"),("suggestions","suggestion"),("summaries","summary"),("surfs","surf"),("surveys","survey"),("swine","swine"),("syllabi","syllabus"),("symbols","symbol"),("synopses","synopsis"),("tabs","tab"),("tables","table"),("taboos","taboo"),("tags","tag"),("tallies","tally"),("targets","target"),("taxes","tax"),("templates","template"),("termini","terminus"),("testes","testis"),("texts","text"),("textareas","textarea"),("textboxes","textbox"),("themes","theme"),("theses","thesis"),("thresholds","threshold"),("thumbnails","thumbnail"),("ticks","tick"),("tickets","ticket"),("tiles","tile"),("times","time"),("time-lapses","time-lapse"),("timeouts","timeout"),("timers","timer"),("timestamps","timestamp"),("timezones","timezone"),("titles","title"),("toggles","toggle"),("tokens","token"),("tomatoes","tomato"),("tooltips","tooltip"),("teeth","tooth"),("toothbrushes","toothbrush"),("totals","total"),("touches","touch"),("townspeople","townsperson"),("traces","trace"),("tracers","tracer"),("tracks","track"),("trackers","tracker"),("transactions","transaction"),("translations","translation"),("transports","transport"),("trees","tree"),("triggers","trigger"),("trilbys","trilby"),("trousers","trousers"),("trout","trout"),("tries","try"),("tuna","tuna"),("turfs","turf"),("types","type"),("unknowns","unknown"),("updates","update"),("uploads","upload"),("users","user"),("vacancies","vacancy"),("validations","validation"),("validators","validator"),("values","value"),("vampires","vampire"),("variables","variable"),("verbs","verb"),("versions","version"),("vertebrae","vertebra"),("vertices","vertex"),("verticals","vertical"),("views","view"),("viewports","viewport"),("viri","virus"),("visits","visit"),("vortices","vortex"),("votes","vote"),("walls","wall"),("warnings","warning"),("watches","watch"),("waves","wave"),("waxes","wax"),("webs","web"),("websites","website"),("weeks","week"),("weights","weight"),("werewolves","werewolf"),("wharves","wharf"),("wheels","wheel"),("whiskeys","whiskey"),("widgets","widget"),("widths","width"),("wives","wife"),("wildebeest","wildebeest"),("windows","window"),("wolves","wolf"),("women","woman"),("words","word"),("works","work"),("workings","working"),("wraps","wrap"),("wrappers","wrapper"),("writes","write"),("writers","writer"),("years","year"),("zips","zip"),("zones","zone"),("zoos","zoo"),("zooms","zoom")]
